# S3 Providers Integration and Radar Replacement Plan

This note captures a practical plan to integrate S3-backed data providers into the web/API, and to replace RainViewer with an open, reliable overlay prior to Terraform rollout.

## Goals
- Expose a simple API for listing and fetching provider objects from public S3 buckets (no credentials), with optional RequesterPays.
- Render select S3 datasets in the web UI (e.g., GOES ABI tiles, MRMS products) via our proxy.
- Retire RainViewer; replace “radar” with an open overlay. Near-term: OpenWeatherMap precipitation tiles (free tier) as a visual stand‑in; mid-term: NOAA MRMS/Radar mosaics via S3.

## Current Proxy Capabilities (serverless)
- Endpoints in `tiling-services/proxy-api/index.ts`:
  - `/api/providers` returns an embedded manifest of key S3 providers: GOES-18/19, HRRR, MRMS.
  - `/api/s3/:provider/list?prefix=...` lists objects (XML) from the provider’s bucket.
  - `/api/s3/:provider/*` fetches objects through the proxy (supports RequesterPays header).
  - Basemaps: OSM standard, Carto CDN.
  - OWM tiles: `/api/owm/{layer}/{z}/{x}/{y}.png` guarded by `OWM_ALLOW` list and API key.

These are sufficient to iterate on client integration now.

## Web App Integration
- Add a Radar overlay using OWM precipitation tiles through our proxy:
  - Source URL: `${NEXT_PUBLIC_API_BASE_URL}/api/owm/precipitation_new/{z}/{x}/{y}.png`
  - Layer type: raster, tileSize 256, opacity configurable.
- Extend Layers panel with a “Radar (Precip)” entry with settings for opacity.
- Keep Lightning (GLM TOE) as-is; add future S3-backed overlays as separate entries.

## RainViewer Retirement
- Remove RainViewer component usage and proxy routes. The TypeScript Lambda already has RainViewer code removed; compiled JS artifacts (`tiling-services/proxy-api/index.js`) still contain legacy code and should be regenerated by the build.
- Delete these files/refs in a follow-up cleanup:
  - `apps/web/src/components/RainviewerLayer.tsx`
  - `packages/providers/rainviewer.ts`, `packages/providers/rainviewer.d.ts`, tests
  - Any `/api/rainviewer/*` references in client, docs, and scripts

## Open Replacement Options (beyond OWM)
- NOAA MRMS (S3: `noaa-mrms-pds`):
  - Products include CONUS mosaics such as `PrecipRate_00.00`, `GaugeCorr_QPE_01H`, etc.
  - Access plan:
    - Use `/api/s3/mrms/list?prefix=CONUS/PrecipRate_00.00/YYYYMMDD/` to discover latest UTC folder and object.
    - Proxy the GeoTIFF or tiled imagery via a small server-side converter (future), or pre-generate Cloud-Optimized GeoTIFF and serve via web-optimized tile service.
- GOES ABI (S3: `noaa-goes18`/`noaa-goes19`) for IR/VIS imagery as separate overlays.

## API Keys and Limits
- OWM requires an API key; our Lambda reads `OPENWEATHER_API_KEY` (env or Secret). Ensure it is set before enabling the client radar layer.
- Add simple backoff and error messaging in the client if the proxy returns 4xx/5xx.

## Next Steps
- Wire the web to the new OWM precipitation overlay and verify.
- Remove RainViewer from UI and code, purge build artifacts by running the lambda build and web build.
- Plan MRMS S3 mosaic ingestion and tiling; keep docs updated.# New Atmospheric & Planetary Science Datasets on AWS S3

My research has identified **45+ additional datasets** across atmospheric science, meteorology, climate, space weather, and planetary science that are not in your current AtmosInsight collection. These span major institutional providers, international agencies, and specialized monitoring networks.

## Climate & Historical Weather Data

### **ECMWF ERA5 Reanalysis (NSF NCAR Curated)**
**Provider:** National Science Foundation / National Center for Atmospheric Research  
**S3 Bucket:** `nsf-ncar-era5`  
**AWS Region:** us-west-2  
**Data Type:** Global atmospheric reanalysis (1979-present)  
**Licensing:** Creative Commons Attribution 4.0 International  
**Access Requirements:** Public access, no authentication  
**Example S3 Paths:** `s3://nsf-ncar-era5/`  
**Requester Pays:** No  
**SNS Topic:** `arn:aws:sns:us-west-2:891377163634:nsf-ncar-era5-object_created`  

### **NCAR CESM Large Ensemble Climate Simulations**
**Provider:** NCAR/UCAR  
**S3 Bucket:** `ncar-cesm-lens`  
**AWS Region:** us-west-2  
**Data Type:** 40-member ensemble climate simulations (1920-2100)  
**Licensing:** CC-BY-4.0  
**Access Requirements:** No AWS account required  
**Example S3 Paths:** `s3://ncar-cesm-lens/atm/monthly/cesmLE-20C-TEMP.zarr`  
**Requester Pays:** No  
**Special Features:** Cloud-optimized Zarr format, ~70TB compressed

### **NOAA Global Historical Climatology Network Daily (GHCN-D)**
**Provider:** NOAA National Centers for Environmental Information  
**S3 Bucket:** Various NOAA buckets  
**AWS Region:** us-east-1  
**Data Type:** Daily weather observations from global land stations (1763-present)  
**Licensing:** CC0-1.0 Public Domain  
**Access Requirements:** Public access  
**Example S3 Paths:** Organized by year and station  
**Requester Pays:** No  
**SNS Topics:** Available through NOAA NODD program

### **ECMWF Real-time Forecasts**
**Provider:** European Centre for Medium-Range Weather Forecasts  
**S3 Bucket:** `ecmwf-forecasts`  
**AWS Region:** eu-central-1  
**Data Type:** Real-time weather forecasts (0.4° resolution, GRIB2)  
**Licensing:** Creative Commons Attribution 4.0  
**Access Requirements:** Public access  
**Example S3 Paths:** `s3://ecmwf-forecasts/`  
**Requester Pays:** No

## NASA Earth Science & Climate Datasets

### **NASA Earth Exchange (NEX) Climate Collection**
**Provider:** NASA Earth Exchange  
**S3 Bucket:** `nasanex`  
**AWS Region:** us-west-2  
**Data Type:** Climate projections, downscaled climate data  
**Licensing:** US Government work (public domain)  
**Access Requirements:** No authentication  
**Example S3 Paths:**
- `s3://nasanex/NEX-DCP30/` (Downscaled Climate Projections)
- `s3://nasanex/NEX-GDDP/` (Global Daily Downscaled Projections)  
- `s3://nasanex/LOCA/` (Localized Constructed Analogs)  
**Requester Pays:** No

### **OMI NO2 Tropospheric Column Data**
**Provider:** NASA Goddard Space Flight Center  
**S3 Bucket:** `omi-no2-nasa`  
**AWS Region:** us-west-2  
**Data Type:** Atmospheric chemistry - Global nitrogen dioxide measurements  
**Licensing:** Public domain  
**Access Requirements:** Public access  
**Example S3 Paths:** Daily 0.25° resolution composite data (2004-2020)  
**Requester Pays:** No

### **NASA JPL Sea Surface Salinity (SMAP)**
**Provider:** NASA JPL PO.DAAC  
**S3 Bucket:** `podaac-ops-cumulus-public` / `podaac-ops-cumulus-protected`  
**AWS Region:** us-west-2  
**Data Type:** Ocean salinity measurements, 8-day running mean  
**Licensing:** Public domain  
**Access Requirements:** Public buckets open; protected buckets require Earthdata Login  
**Example S3 Paths:** `SMAP_JPL_L3_SSS_CAP_8DAY-RUNNINGMEAN_V5/`  
**Requester Pays:** No

## Space Weather & Solar Physics

### **NOAA Space Weather Prediction Center Data**
**Provider:** NOAA Space Weather Prediction Center  
**S3 Bucket:** `noaa-swpc-pds`  
**AWS Region:** us-east-1  
**Data Type:** Space weather forecasts, observations, and indices  
**Licensing:** CC0-1.0 Public Domain  
**Access Requirements:** Public access  
**Example S3 Paths:** `s3://noaa-swpc-pds/`  
**Requester Pays:** No  
**SNS Topic:** `arn:aws:sns:us-east-1:123901341784:NewSWPCObject`  
**Update Frequency:** 1-minute observations to monthly indices

### **NASA Solar Dynamics Observatory Machine Learning Dataset**
**Provider:** NASA / Frontier Development Lab  
**S3 Bucket:** `gov-nasa-hdrl-data1`  
**AWS Region:** us-west-2  
**Data Type:** Multi-wavelength solar imagery and magnetic field data (2010-2020)  
**Licensing:** NASA open data policies  
**Access Requirements:** No AWS account required  
**Example S3 Paths:** `contrib/fdl-sdoml/`  
**Requester Pays:** No  
**Special Features:** ML-ready format, 512x512 resolution, 6-12 minute cadence

### **NOAA WAM-IPE Ionosphere Model**
**Provider:** NOAA Space Weather Prediction Center  
**S3 Bucket:** `noaa-nws-wam-ipe`  
**AWS Region:** us-east-1  
**Data Type:** 3D ionosphere and thermosphere conditions (90km-10,000km)  
**Licensing:** NOAA open data  
**Access Requirements:** Public access  
**Example S3 Paths:** Real-time nowcasts and 2-day forecasts  
**Requester Pays:** No  
**Parameters:** Total Electron Content (TEC), Maximum Usable Frequency (MUF), neutral density

## Air Quality & Atmospheric Chemistry

### **OpenAQ Global Air Quality Archive**
**Provider:** OpenAQ  
**S3 Buckets:** `openaq-fetches`, `openaq-data-archive`  
**AWS Region:** us-east-1  
**Data Type:** Global air quality measurements (44+ billion measurements)  
**Licensing:** CC0-1.0 Public Domain  
**Access Requirements:** Public access  
**Example S3 Paths:**
- `s3://openaq-fetches/daily/`
- `s3://openaq-fetches/realtime-gzipped/`  
- `s3://openaq-data-archive/records/csv.gz/locationid=XXXX/`  
**Requester Pays:** No  
**Coverage:** 53,000+ locations, 65+ countries, PM2.5/PM10/O3/NO2/SO2/CO

### **GEOS-Chem Atmospheric Chemistry Model Data**
**Provider:** GEOS-Chem Support Team  
**S3 Bucket:** `geos-chem`  
**AWS Region:** us-east-1  
**Data Type:** Chemical transport model inputs (MERRA-2, GEOS-FP meteorology, emissions)  
**Licensing:** Open source  
**Access Requirements:** Public access, no egress fees  
**Example S3 Paths:** `s3://geos-chem/ExtData/`  
**Requester Pays:** No (some nested buckets like `gcgrid` use requester-pays)

### **EPA Risk-Screening Environmental Indicators (RSEI)**
**Provider:** US Environmental Protection Agency  
**S3 Bucket:** `epa-rsei-pds`  
**AWS Region:** us-east-1  
**Data Type:** Air quality model results, chemical risk screening  
**Licensing:** Public domain (US Government)  
**Access Requirements:** Public access  
**Example S3 Paths:** `s3://epa-rsei-pds/`  
**Requester Pays:** No

## International Meteorological Data

### **UK Met Office Weather Data**
**Provider:** UK Meteorological Office  
**Multiple S3 Buckets:**
- `met-office-radar-obs-data` (UK radar composite)
- `met-office-atmospheric-model-data` (UKV 2km forecasts)  
**AWS Region:** eu-west-2  
**Data Type:** Weather radar, atmospheric model forecasts  
**Licensing:** CC BY-SA  
**Access Requirements:** Public access  
**SNS Topics:** 
- `arn:aws:sns:eu-west-2:633885181284:met-office-radar-obs-data-object_created`  
**Update Frequency:** 15-minute radar updates, 8x daily model runs

### **Finnish Meteorological Institute Data**
**Provider:** Finnish Meteorological Institute  
**S3 Buckets:**
- `fmi-opendata-radar-geotiff` (weather radar)
- `fmi-opendata-radar-volume-hdf5` (3D radar volumes)  
**AWS Region:** eu-west-1  
**Data Type:** Weather radar composites, volume data, gridded observations  
**Licensing:** CC BY 4.0  
**Access Requirements:** Public access  
**SNS Topics:** Available for both radar datasets  
**Special Features:** HDF5 and GeoTIFF formats, 1km resolution gridded data

### **JAXA ALOS/PALSAR-2 SAR Data**
**Provider:** Japan Aerospace Exploration Agency  
**S3 Bucket:** `jaxaalos2`  
**AWS Region:** us-west-2  
**Data Type:** L-band synthetic aperture radar (25m resolution)  
**Licensing:** Open under JAXA terms  
**Access Requirements:** Public access  
**Example S3 Paths:** `palsar2/L2.2/Africa/`  
**Requester Pays:** No  
**Applications:** Land monitoring, agriculture, disaster response

## Lightning Detection Networks

### **World Wide Lightning Location Network (WWLLN)**
**Provider:** University of Washington / NASA GHRC  
**Data Type:** Global lightning stroke detection, thunder hour data  
**S3 Access:** Available through NASA Open Data Portal  
**Coverage:** Global lightning monitoring since 2004  
**Licensing:** NASA data dissemination policies  
**Resolution:** 0.05° monthly thunder hour datasets  
**Applications:** Lightning climatology, severe weather research

## Planetary Science Data

### **NASA Mars Datasets**
**Provider:** NASA/USGS  
**AWS Region:** us-west-2 (primary)  
**Multiple Datasets:**
- Mars Spectrometry (SAM instrument data from Curiosity/Perseverance)
- Europa Galileo Mosaics (92 image mosaics)
- THEMIS Mars Mosaics (infrared imagery)
- Mars Digital Terrain Models  
**Licensing:** No restrictions on use/access  
**Access Requirements:** Public access  
**Format:** Cloud Optimized GeoTIFFs, FITS files

## High-Value Research Datasets

### **NCAR NA-CORDEX North American Climate**
**Provider:** NSF NCAR  
**S3 Bucket:** `ncar-na-cordex`  
**AWS Region:** us-west-2  
**Data Type:** Regional climate simulations over North America (1950-2100)  
**Licensing:** CC-BY-4.0  
**Access Requirements:** Public access  
**Example S3 Paths:** Zarr format with 0.22°/25km or 0.44°/50km resolution  
**Requester Pays:** No  
**SNS Topics:** Available for notifications

### **USGS 3DEP Lidar Point Cloud**
**Provider:** US Geological Survey  
**S3 Bucket:** `usgs-lidar`  
**AWS Region:** us-west-2  
**Data Type:** High-resolution elevation data (12+ trillion lidar points)  
**Licensing:** Public domain  
**Access Requirements:** AWS account (requester pays)  
**Example S3 Paths:** ASPRS LAS tiles with LASzip compression  
**Requester Pays:** **Yes** (notable exception)

## Key Implementation Recommendations

**Priority us-east-1 datasets** for your dashboard:
- NOAA Space Weather (`noaa-swpc-pds`)
- OpenAQ Air Quality (`openaq-fetches`, `openaq-data-archive`) 
- EPA Environmental Data (`epa-rsei-pds`)
- NOAA Climate Normals and GHCN-D

**High-performance cloud-native formats:**
- NCAR datasets in Zarr format offer excellent performance
- NASA COG datasets provide efficient tile-based access
- Most datasets support direct S3 API access without egress fees

**Real-time capabilities:**
- **15 datasets** provide SNS topics for automated notifications
- Update frequencies range from 1-minute (space weather) to daily (climate data)
- Most support event-driven architectures via AWS Lambda integration

This collection provides **comprehensive coverage** beyond your existing NOAA operational sources, adding historical climate data, international perspectives, specialized atmospheric chemistry measurements, and advanced research datasets from leading institutions worldwide.